---
keywords: fastai
description: "In this article we survey a number of basic causal inference algorithms and how to implement them in Python."
title: "An overview of basic causal inference algorithms and how to implement them from scratch in Python"
published: false
toc: true
branch: master
badges: true
comments: true
categories: [causal inference, python]
nb_path: _notebooks/2020-05-10-Overview_basic_causal_inference_algorithms_from_scratch_in_Python.ipynb
layout: notebook
---

<!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2020-05-10-Overview_basic_causal_inference_algorithms_from_scratch_in_Python.ipynb
-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Why-causal-inference-and-not-machine-learning?">Why causal inference and not machine learning?<a class="anchor-link" href="#Why-causal-inference-and-not-machine-learning?"> </a></h2><p>Businesses, enterprises, and industries often face questions of cause and effect:</p>
<ul>
<li>How does offering my customers a discount change their purchase behavior?</li>
<li>How does tweaking this one variable in my manufacturing process change the quality of my product?</li>
<li>How does altering this one mechanical piece change the overall behavior of my machinery?</li>
<li>How does addressing my customers via e-mail or through a planned marketing campaign change their willingness to buy my product?</li>
</ul>
<p>Each of these planned interventions or manipulation of your business, your pricing policy,
manufacturing process, or your complex machinery changes the way the process of interest changes
because you change the data generation mechanism by placing in a new regime.</p>
<p>Thinking in terms of these business interventions and how they affect your operations is a natural process in all businesses, enterprises, and industries.
However, our common toolset of descriptive and predictive data analytics (machine learning) does, in most instances, not provide useful answers to these questions.</p>
<p>While machine learning methodologies are uniquely geared towards uncovering patterns in your observed data, they are limited to already observed patterns in your data.</p>
<p>So if you haven't yet tested the effects of that 10% discount on your sales, change in raw materials on your product's quality, or increase in stifness of that one spring on your machinery's vibrations then machine learning
won't be able to tell you.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Prediction-vs.-explanation">Prediction vs. explanation<a class="anchor-link" href="#Prediction-vs.-explanation"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>You're the head of your sales department and need to figure out whether to write your customer
or client that e-mail either reminding them of your shop's product range or offering them a discount.</p>
<p>Essentially you're trying to predict effect of your e-mail intervention in the following causal model:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_svg output_subarea output_execute_result">
<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: G Pages: 1 -->
<svg width="192pt" height="44pt"
 viewBox="0.00 0.00 192.46 44.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 40)">
<title>G</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-40 188.4575,-40 188.4575,4 -4,4"/>
<!-- e&#45;mail -->
<g id="node1" class="node">
<title>e&#45;mail</title>
<ellipse fill="none" stroke="#000000" cx="32.6948" cy="-18" rx="32.8908" ry="18"/>
<text text-anchor="middle" x="32.6948" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">e&#45;mail</text>
</g>
<!-- purchase -->
<g id="node2" class="node">
<title>purchase</title>
<ellipse fill="none" stroke="#000000" cx="142.9235" cy="-18" rx="41.5679" ry="18"/>
<text text-anchor="middle" x="142.9235" y="-13.8" font-family="Times,serif" font-size="14.00" fill="#000000">purchase</text>
</g>
<!-- e&#45;mail&#45;&gt;purchase -->
<g id="edge1" class="edge">
<title>e&#45;mail&#45;&gt;purchase</title>
<path fill="none" stroke="#000000" d="M65.4686,-18C73.4965,-18 82.2857,-18 90.9698,-18"/>
<polygon fill="#000000" stroke="#000000" points="91.0642,-21.5001 101.0641,-18 91.0641,-14.5001 91.0642,-21.5001"/>
</g>
</g>
</svg>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There are at least two questions to ask regarding this model:</p>
<ol>
<li>How will I affect the purchase likelihood of my customer / client if I send them an e-mail now?</li>
<li>My customer / client purchased after I sent them an e-mail. What would have happened had I not sent them that e-mail?</li>
</ol>
<p>The first question asks for a prediction, and is referred to as hypothetical causation, while the second question
asks for an explanation, or counterfactual causation.</p>
<p>Prediction is more tractable than explanation and therefore the focus of this article.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Seeing-vs.-doing">Seeing vs. doing<a class="anchor-link" href="#Seeing-vs.-doing"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="References">References<a class="anchor-link" href="#References"> </a></h2><ul>
<li><a href="http://www.homepages.ucl.ac.uk/~ucgtrbd/talks/imperial_causality.pdf">http://www.homepages.ucl.ac.uk/~ucgtrbd/talks/imperial_causality.pdf</a></li>
</ul>

</div>
</div>
</div>
</div>
 

